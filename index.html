<!DOCTYPE html>
<html>
<head>
  <title>Luna Voice Chat</title>
</head>
<body>
  <h2>Talk to Luna</h2>
  <button onclick="startListening()">Start Talking</button>
  <p id="transcript">Your speech will appear here...</p>
  <p id="response">Luna will reply here...</p>

<script>
let lunaEndpoint = "<PUT_YOUR_NGROK_URL_HERE>/ask";

function startListening() {
  const recognition = new webkitSpeechRecognition();
  recognition.lang = "en-US";
  recognition.onresult = function(event) {
    const userText = event.results[0][0].transcript;
    document.getElementById("transcript").innerText = "You: " + userText;
    sendToLuna(userText);
  };
  recognition.start();
}

function sendToLuna(message) {
  fetch(lunaEndpoint, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ message: message })
  })
  .then(res => res.json())
  .then(data => {
    const reply = data.response;
    document.getElementById("response").innerText = reply;
    speak(reply);
  });
}

function speak(text) {
  const synth = window.speechSynthesis;
  const utter = new SpeechSynthesisUtterance(text);
  synth.speak(utter);
}
</script>
</body>
</html>
